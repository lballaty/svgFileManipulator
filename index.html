<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Interactive SVG Pie Chart Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 20px;
        }
        #controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
        }
        .slice-inputs {
            display: flex;
            flex-direction: row;
            align-items: center;
            margin-bottom: 10px;
        }
        .slice-inputs label {
            margin-right: 10px;
        }
        .slice-inputs input {
            margin-right: 5px;
        }
        #pieChart {
            border: 1px solid #ccc;
            margin-top: 20px;
            transform-origin: center;
        }
        #exportButton {
            margin-top: 20px;
        }
        #svgOutput {
            width: 80%;
            height: 200px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Interactive SVG Pie Chart Generator</h1>
    <div id="controls">
        <label for="chartTitle">Chart Title:</label>
        <input type="text" id="chartTitle" placeholder="Enter chart title">
        <br>
        <label for="sliceCount">Number of Slices:</label>
        <input type="number" id="sliceCount" min="1" value="3" onchange="generateSliceInputs()">
        <div id="sliceInputsContainer"></div>
        <label for="unit">Unit (e.g., %, $):</label>
        <input type="text" id="unit" placeholder="Enter unit">
        <br>
        <label for="rotation">Rotation (degrees):</label>
        <input type="number" id="rotation" value="0">
        <br>
        <button onclick="updateChart()">Update Chart</button>
    </div>
    <svg id="pieChart" width="400" height="400" viewBox="-1.5 -1.5 3 3"></svg>
    <button id="exportButton" onclick="exportSVG()">Export SVG</button>
    <textarea id="svgOutput" readonly></textarea>

    <script>
        function generateSliceInputs() {
            const sliceCount = document.getElementById('sliceCount').value;
            const container = document.getElementById('sliceInputsContainer');
            container.innerHTML = '';

            for (let i = 0; i < sliceCount; i++) {
                const sliceDiv = document.createElement('div');
                sliceDiv.className = 'slice-inputs';

                const labelInput = document.createElement('input');
                labelInput.type = 'text';
                labelInput.placeholder = `Label for slice ${i + 1}`;
                labelInput.className = 'slice-label';

                const valueInput = document.createElement('input');
                valueInput.type = 'number';
                valueInput.placeholder = `Value for slice ${i + 1}`;
                valueInput.className = 'slice-value';

                const colorInput = document.createElement('input');
                colorInput.type = 'color';
                colorInput.value = '#'+Math.floor(Math.random()*16777215).toString(16);
                colorInput.className = 'slice-color';

                sliceDiv.appendChild(labelInput);
                sliceDiv.appendChild(valueInput);
                sliceDiv.appendChild(colorInput);
                container.appendChild(sliceDiv);
            }
        }

        function updateChart() {
            if (!validateInputs()) {
                return;
            }

            const svg = document.getElementById('pieChart');
            svg.innerHTML = ''; // Clear previous chart

            const chartTitle = document.getElementById('chartTitle').value;
            if (chartTitle) {
                const titleElement = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                titleElement.setAttribute('x', '0');
                titleElement.setAttribute('y', '-1.2');
                titleElement.setAttribute('text-anchor', 'middle');
                titleElement.setAttribute('font-size', '0.2');
                titleElement.textContent = chartTitle;
                svg.appendChild(titleElement);
            }

            const labels = Array.from(document.getElementsByClassName('slice-label')).map(input => input.value);
            const values = Array.from(document.getElementsByClassName('slice-value')).map(input => parseFloat(input.value));
            const colors = Array.from(document.getElementsByClassName('slice-color')).map(input => input.value);
            const unit = document.getElementById('unit').value;
            const rotation = parseFloat(document.getElementById('rotation').value) || 0;

            const total = values.reduce((acc, val) => acc + val, 0);
            let cumulativePercent = 0;

            svg.setAttribute('transform', `rotate(${rotation})`);

            values.forEach((value, index) => {
                const [startX, startY] = getCoordinatesForPercent(cumulativePercent);
                cumulativePercent += value / total;
                const [endX, endY] = getCoordinatesForPercent(cumulativePercent);
                const largeArcFlag = value / total > 0.5 ? 1 : 0;

                const pathData = [
                    `M ${startX} ${startY}`,
                    `A 1 1 0 ${largeArcFlag} 1 ${endX} ${endY}`,
                    'L 0 0',
                ].join(' ');

                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('fill', colors[index]);
                svg.appendChild(path);

                const labelAngle = (cumulativePercent - value / total / 2) * 2 * Math.PI;
                const labelX = 0.7 * Math.cos(labelAngle);
                const labelY = 0.7 * Math.sin(labelAngle);

                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', labelX);
                text.setAttribute('y', labelY);
                text.setAttribute('text-anchor', 'middle');
                text.setAttribute('font-size', '0.1');
                text.textContent = `${labels[index]}: ${value}${unit}`;
                svg.appendChild(text);
            });

            updateSVGOutput();
        }

        function validateInputs() {
            const labels = Array.from(document.getElementsByClassName('slice-label')).map(input => input.value.trim());
            const values = Array.from(document.getElementsByClassName('slice-value')).map(input => parseFloat(input.value));
            const rotation = parseFloat(document.getElement
::contentReference[oaicite:0]{index=0}
 
